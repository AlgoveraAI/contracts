<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/v3/Dispenser.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">contracts/v3/</a> Dispenser.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/58</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/42</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/9</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/58</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity 0.5.7;
// Copyright BigchainDB GmbH and Ocean Protocol contributors
// SPDX-License-Identifier: (Apache-2.0 AND CC-BY-4.0)
// Code is Apache-2.0 and docs are CC-BY-4.0
&nbsp;
import './IDataTokenTemplate.sol';
&nbsp;
&nbsp;
&nbsp;
contract Dispenser {
    struct DataToken {
        bool active;  // if the dispenser is active for this datatoken
        address owner; // owner of this dispenser
        bool minterApproved; // if the dispenser is a minter for this datatoken
        uint256 maxTokens; // max tokens to dispense
        uint256 maxBalance; // max balance of requester. 
        //If the balance is higher, the dispense is rejected
    }
    mapping(address =&gt; DataToken) datatokens;
    address[] public datatokensList;
<span class="fstat-no" title="function not covered" >    constructor() public {}</span>
    
    event Activated(  // emited when a dispenser is activated
        address indexed datatokenAddress
    );
&nbsp;
    event Deactivated( // emited when a dispenser is deactivated
        address indexed datatokenAddress
    );
&nbsp;
    event AcceptedMinter( 
        // emited when a dispenser becomes minter of the datatoken
        address indexed datatokenAddress
    );
&nbsp;
    event RemovedMinter( 
        // emited when a dispenser if removed as minter of the datatoken
        address indexed datatokenAddress
    );
&nbsp;
    event TokensDispensed( 
        // emited when tokens are dispended
        address indexed datatokenAddress,
        address indexed userAddress,
        uint256 amount
    );
&nbsp;
    event OwnerWithdrawed(
        address indexed datatoken,
        address indexed owner,
        uint256 amount
    );
&nbsp;
    /**
     * @dev status
     *      Get information about a datatoken dispenser
     * @param datatoken refers to datatoken address.
     * @return active - if the dispenser is active for this datatoken
     * @return owner - owner of this dispenser
     * @return minterApproved - if the dispenser is a minter for this datatoken
     * @return isTrueMinter  - check the datatoken contract if this contract is really a minter
     * @return maxTokens - max tokens to dispense
     * @return maxBalance - max balance of requester. If the balance is higher, the dispense is rejected
     * @return balance - internal balance of the contract (if any)
     */
<span class="fstat-no" title="function not covered" >    function status(address datatoken) </span>
    external view 
    returns(bool active,address owner,bool minterApproved,
    bool isTrueMinter,uint256 maxTokens,uint256 maxBalance, uint256 balance){
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        active = datatokens[datatoken].active</span>;
<span class="cstat-no" title="statement not covered" >        owner = datatokens[datatoken].owner</span>;
<span class="cstat-no" title="statement not covered" >        minterApproved = datatokens[datatoken].minterApproved</span>;
<span class="cstat-no" title="statement not covered" >        maxTokens = datatokens[datatoken].maxTokens</span>;
<span class="cstat-no" title="statement not covered" >        maxBalance = datatokens[datatoken].maxBalance</span>;
<span class="cstat-no" title="statement not covered" >        IDataTokenTemplate tokenInstance = IDataTokenTemplate(datatoken);</span>
<span class="cstat-no" title="statement not covered" >        balance = tokenInstance.balanceOf(address(this))</span>;
<span class="cstat-no" title="statement not covered" >        isTrueMinter = tokenInstance.isMinter(address(this))</span>;
    }
&nbsp;
    /**
     * @dev activate
     *      Activate a new dispenser
     * @param datatoken refers to datatoken address.
     * @param maxTokens - max tokens to dispense
     * @param maxBalance - max balance of requester.
     */
<span class="fstat-no" title="function not covered" >    function activate(address datatoken,uint256 maxTokens, uint256 maxBalance)</span>
        external {
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatokens[datatoken].owner == address(0) || datatokens[datatoken].owner == msg.sender,
            'DataToken already activated'
        );
<span class="cstat-no" title="statement not covered" >        IDataTokenTemplate tokenInstance = IDataTokenTemplate(datatoken);</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            tokenInstance.isMinter(msg.sender),
            'Sender does not have the minter role'
        );
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].active = true</span>;
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].owner = msg.sender</span>;
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].maxTokens = maxTokens</span>;
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].maxBalance = maxBalance</span>;
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].minterApproved = false</span>;
<span class="cstat-no" title="statement not covered" >        datatokensList.push(datatoken)</span>;
<span class="cstat-no" title="statement not covered" >        emit Activated(datatoken);</span>
    }
&nbsp;
    /**
     * @dev deactivate
     *      Deactivate an existing dispenser
     * @param datatoken refers to datatoken address.
     */
<span class="fstat-no" title="function not covered" >    function deactivate(address datatoken) external{</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatokens[datatoken].owner == msg.sender,
            'DataToken already activated'
        );
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].active = false</span>;
<span class="cstat-no" title="statement not covered" >        emit Deactivated(datatoken);</span>
    }
&nbsp;
    /**
     * @dev acceptMinter
     *      Accepts Minter role  (existing datatoken minter has to call datatoken.proposeMinter(dispenserAddress) first)
     * @param datatoken refers to datatoken address.
     */
<span class="fstat-no" title="function not covered" >    function acceptMinter(address datatoken) external{</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        IDataTokenTemplate tokenInstance = IDataTokenTemplate(datatoken);</span>
<span class="cstat-no" title="statement not covered" >        tokenInstance.approveMinter()</span>;
<span class="cstat-no" title="statement not covered" >        require(</span>
            tokenInstance.isMinter(address(this)),
            'ERR: Cannot accept minter role'
        );
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].minterApproved = true</span>;
<span class="cstat-no" title="statement not covered" >        emit AcceptedMinter(datatoken);</span>
    }
    /**
     * @dev removeMinter
     *      Removes Minter role and proposes the owner as a new minter (the owner has to call approveMinter after this)
     * @param datatoken refers to datatoken address.
     */
<span class="fstat-no" title="function not covered" >    function removeMinter(address datatoken) external{</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatokens[datatoken].owner == msg.sender,
            'DataToken already activated'
        );
<span class="cstat-no" title="statement not covered" >        IDataTokenTemplate tokenInstance = IDataTokenTemplate(datatoken);</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            tokenInstance.isMinter(address(this)),
            'ERR: Cannot accept minter role'
        );
<span class="cstat-no" title="statement not covered" >        tokenInstance.proposeMinter(datatokens[datatoken].owner)</span>;
<span class="cstat-no" title="statement not covered" >        datatokens[datatoken].minterApproved = false</span>;
<span class="cstat-no" title="statement not covered" >        emit RemovedMinter(datatoken);</span>
    }
&nbsp;
    /**
     * @dev dispense
     *      Dispense datatokens to caller. The dispenser must be active, hold enough DT (or be able to mint more) and respect maxTokens/maxBalance requirements
     * @param datatoken refers to datatoken address.
     * @param datatoken amount of datatokens required.
     */
<span class="fstat-no" title="function not covered" >    function dispense(address datatoken, uint256 amount) external payable{</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatokens[datatoken].active == true,
            'Dispenser not active'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            amount &gt; 0,
            'Invalid zero amount'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatokens[datatoken].maxTokens &gt;= amount,
            'Amount too high'
        );
<span class="cstat-no" title="statement not covered" >        IDataTokenTemplate tokenInstance = IDataTokenTemplate(datatoken);</span>
<span class="cstat-no" title="statement not covered" >        uint256 callerBalance = tokenInstance.balanceOf(msg.sender);</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            callerBalance&lt;datatokens[datatoken].maxBalance,
            'Caller balance too high'
        );
<span class="cstat-no" title="statement not covered" >        uint256 ourBalance = tokenInstance.balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >        if(ourBalance&lt;amount &amp;&amp; tokenInstance.isMinter(address(this))){ </span>
            //we need to mint the difference if we can
<span class="cstat-no" title="statement not covered" >            tokenInstance.mint(address(this),amount - ourBalance)</span>;
<span class="cstat-no" title="statement not covered" >            ourBalance = tokenInstance.balanceOf(address(this))</span>;
        }
<span class="cstat-no" title="statement not covered" >        require(</span>
            ourBalance&gt;=amount,
            'Not enough reserves'
        );
<span class="cstat-no" title="statement not covered" >        tokenInstance.transfer(msg.sender,amount)</span>;
<span class="cstat-no" title="statement not covered" >        emit TokensDispensed(datatoken, msg.sender, amount);</span>
    }
&nbsp;
    /**
     * @dev ownerWithdraw
     *      Allow owner to withdraw all datatokens in this dispenser balance
     * @param datatoken refers to datatoken address.
     */
<span class="fstat-no" title="function not covered" >    function ownerWithdraw(address datatoken) external{</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatoken != address(0),
            'Invalid token contract address'
        );
<span class="cstat-no" title="statement not covered" >        require(</span>
            datatokens[datatoken].owner == msg.sender,
            'Invalid owner'
        );
<span class="cstat-no" title="statement not covered" >        IDataTokenTemplate tokenInstance = IDataTokenTemplate(datatoken);</span>
<span class="cstat-no" title="statement not covered" >        uint256 ourBalance = tokenInstance.balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >        if(ourBalance&gt;0){</span>
<span class="cstat-no" title="statement not covered" >            tokenInstance.transfer(msg.sender,ourBalance)</span>;
<span class="cstat-no" title="statement not covered" >            emit OwnerWithdrawed(datatoken, msg.sender, ourBalance);</span>
        }
    }
<span class="fstat-no" title="function not covered" >    function() external payable {</span>
        //thank you for your donation
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu Sep 09 2021 06:59:42 GMT-0500 (Colombia Standard Time)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
